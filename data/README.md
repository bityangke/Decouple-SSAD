
# Prepare THUMOS14 Data

## Get Preprocessed Data
We provide preprocessed data files to directly start training and evaluating.

* The following files have been included in this repository:
	```
	data/thumos14/val/thumos14_val_annotation.csv
	data/thumos14/val/gt_info.pkl
	data/thumos14/val/gt_label.pkl
	data/thumos14/val/window_info.log
	data/thumos14/test/thumos14_test_annotation.csv
	data/thumos14/test/window_info.log
	```
* All relevant sliding window features of THUMOS14 are as follows. 
[Download files](https://mail2sysueducn-my.sharepoint.com/:f:/g/personal/huangyp28_mail2_sysu_edu_cn/Eh9uvfgl5CxCmgvaxoWHKfYBuBmd2QVBhDw6SYgzqcA3ZA?e=beDJuO)
 according to your need.
For example, if you want to test temporal model pretrained on UCF101, you only need to download `test/temporalDataXUCF101`.
 The zip file is about 2.1G and the unzip folder is about 5.4G. There are 4741 npy files (named from 0.npy to 4740.npy)
  in each subfolder for validation set and 5103 npy files (named from `0.npy` to `5102.npy`) in each subfolder for test set.
	* test/spatialDataXUCF101 (2.5G -> 5.4G)
	* test/temporalDataXUCF101 (2.1G -> 5.4G)
	* test/spatialDataXKnetV3 (5.2G -> 10.7G)
	* test/temporalDataXKnetV3 (5.1G -> 10.7G)
	* val/spatialDataXUCF101 (2.4G -> 5.0G)
	* val/temporalDataXUCF101 (2.0G -> 5.0G)
	* val/spatialDataXKnetV3 (4.9G -> 10G)
	* val/temporalDataXKnetV3 (4.8G -> 10G)

## Preprocess Data by Yourself
This part is **not necessary and not recommended** if you get preprocessed data above.
If you want to start from the original THUMOS14 dataset and preprocess data by yourself, following are the instructions.
1. Download [THUMOS14 dataset](https://www.crcv.ucf.edu/THUMOS14/) (only validation and test set are needed)
2. Extract frames and optical flow images refer to [TSN](https://github.com/yjxiong/temporal-segment-networks#extract-frames-and-optical-flow-images).
3. Generate validation and test set ground truth annotations refer to `data/gen_thumos14_anno.py`, 
which is based on [SSN](https://github.com/yjxiong/action-detection).
    ```
	data/thumos14/test/thumos14_test_annotation.csv
	data/thumos14/val/thumos14_val_annotation.csv
    ```
4. These files related to data information will be generated by `python data/get_data_info.py`. 
	```
 	data/thumos14/val/gt_info.pkl
 	data/thumos14/val/gt_label.pkl
 	data/thumos14/val/window_info.log
 	data/thumos14/test/window_info.log
	```
2. Extract sliding window features refer to `data/extract_feature.sh`
